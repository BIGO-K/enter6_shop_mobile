<!DOCTYPE html>
<html lang="ko" class="__mm_popup__">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="format-detection" content="telephone=no, address=no, email=no">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="mobile-web-app-capable" content="yes">

	<!-- 소셜태그 -->
	<meta property="og:title" content="">
	<meta property="og:description" content="">
	<meta property="og:image" content="">
	<meta property="og:url" content="">
	<meta property="og:site_name" content="">
	<!--// 소셜태그 -->

	<title>(팝업) "[5월 이벤트] 매일 행운의 룰렛 돌리고 경품 받으세요! 하루 한번의 찬스! 당첨 선물 놓치지 마세요" 이벤트/혜택 - 엔터식스 온라인몰</title>

	<!-- 라이브러리 css -->
	<link rel="stylesheet" href="../css/libs/fontello-custom.css">
	<link rel="stylesheet" href="../css/libs/swiper-4.4.6.min.css">
	<link rel="stylesheet" href="../css/libs/overlayscrollbars-1.6.1.min.css">
	<link rel="stylesheet" href="../css/libs/pikaday.css">

	<!-- 페이지 css -->
	<link rel="stylesheet" class="link_font" resource="../css/fonts.css">
	<link rel="stylesheet" href="../css/fonts_early.css">
	<link rel="stylesheet" href="../css/app.css">

	<!-- (D) 스크립트(폴리필, 라이브러리)는 요청을 줄이기 위해 combind + minify를 적용해주세요. -->
	<!-- 폴리필 스크립트 -->
	<script src="../js/polyfill/es6-promise.auto-4.2.4.min.js"></script>

	<!-- 라이브러리 스크립트 -->
	<!-- <script src="../js/libs/webfontloader-1.6.28.min.js"></script> -->
	<script src="../js/libs/jquery-3.3.1.slim.min.js"></script>
	<script src="../js/libs/axios-0.18.0.min.js"></script>
	<script src="../js/libs/underscore-1.9.1.min.js"></script>
	<script src="../js/libs/load-image.all-2.20.1.min.js"></script>
	<script src="../js/libs/tweenmax-2.0.2.min.js"></script>
	<script src="../js/libs/swiper-4.4.6.min.js"></script>
	<script src="../js/libs/sortable-1.6.0.min.js"></script>
	<script src="../js/libs/moment-2.23.0.min.js"></script>
	<!-- <script src="../js/libs/cleave-1.4.7.min.js"></script> -->
	<!-- <script src="../js/libs/cleave-1.4.7.phone.kr.js"></script> -->
	<!-- <script src="../js/libs/overlayscrollbars-1.6.1.min.js"></script> -->
	<!-- <script src="../js/libs/pikaday-1.8.0.min.js"></script> -->
	<!-- <script src="../js/libs/handlebars-4.0.12.min.js"></script> -->
	<!-- <script src="../js/libs/template7-1.4.0.min.js"></script> -->
	<!-- <script src="../js/libs/vue-2.5.21.min.js"></script> -->
	<!-- <script src="../js/libs/autoNumeric-4.1.0.min.js"></script> -->
	<!-- <script src="../js/libs/chart-2.7.3.min.js"></script> -->
	<!-- <script src="../js/libs/ckeditor.full-4.10.0/ckeditor.js"></script> -->

	<!-- 공통 선언 스크립트 -->
	<script src="../js/app_common.js"></script>

	<!-- (D) 페이지 공통 스크립트는 body 하단, 전용 스크립트는 .mm_page-content 하단에 넣어주세요. -->
</head>
<body>
	<div id="mm_app" class="mm_app">
		<!-- 스킵 -->
		<nav class="mm_skip">
			<ul>
				<li><a href="#mm_body" data-href="anchor">본문바로가기</a></li>
			</ul>
		</nav>
		<!-- 스킵 -->

		<!-- 화면 -->
		<div class="mm_view">
			<!-- 헤더 -->
			<div class="mm_header">
				<h1><span>이벤트/혜택</span></h1>
				<div class="mm_box-lside">
					<a href="#" data-href="{ '_type': 'back' }"><i class="mco_back"></i><span class="mm_ir-blind">뒤로가기</span></a>
				</div>
				<button type="button" class="btn_popup-close" onclick="mm.popup.close();"><i class="mco_popup-close"></i><span class="mm_ir-blind">팝업 닫기</span></button>
			</div>
			<!--// 헤더 -->

			<!-- 내용 -->
			<div id="mm_body" class="mm_page">
				<div class="mm_scroller">
					<div class="mm_box-flexcolumn">
						<!-- 본문 -->
						<div class="mm_page-content">
							<!-- (D) 실제 내용을 추가하는 부분입니다. -->

							<!-- (D) iframe 팝업은 html 요소에 '__mm_popup__' 클래스를 추가합니다. -->
							<section class="m-popup-event-jumbotron">
								<h3><span>[5월 이벤트] 매일 행운의 룰렛 돌리고 경품 받으세요! <br>하루 한번의 찬스! 당첨 선물 놓치지 마세요</span></h3>

								<!-- 룰렛이벤트 -->
								<div class="m-popup-event-roulette">
									<div class="m--roulette-title">
										<span class="mm_ir-blind">5월 룰렛 이벤트</span>
										<h4 class="mm_ir-blind">매일 행운의 룰렛 돌리고 경품 받으세요!</h4>
										<p class="mm_ir-blind">하루 한번의 찬스! 당첨 선물 놓치지 마세요</p>
									</div>

									<div class="m--roulette-tables">
										<i class="image_roulette-arrow"><img src="../images/content/event/event_roulette_arrow.png" alt=""></i>
										<div class="m--roulette-wheel">
											<ul>
												<li><i class="image_item"><img src="../images/content/event/event_roulette_piece1.png" alt="스타벅스 아메리카노 tall"></i></li>
												<li><i class="image_item"><img src="../images/content/event/event_roulette_piece2.png" alt="KFC 징거버거세트"></i></li>
												<li><i class="image_item"><img src="../images/content/event/event_roulette_piece3.png" alt="엔터식스 50포인트"></i></li>
												<li><i class="image_item"><img src="../images/content/event/event_roulette_piece4.png" alt="베스킨라빈스31 싱글콘"></i></li>
												<li><i class="image_item"><img src="../images/content/event/event_roulette_piece5.png" alt="CGV 영화관람권 티켓"></i></li>
												<li><i class="image_item"><img src="../images/content/event/event_roulette_piece6.png" alt="아쉬워요 다음기회에"></i></li>
											</ul>
										</div>
										<button type="button" class="btn_start"><i class="image_start"><img src="../images/content/event/event_roulette_btn.png" alt="룰렛돌리기 START"></i></button>
										<div class="m--roulette-result">
											<button type="button" class="btn_close"><span class="mm_ir-blind">닫기</span></button>
										</div>
									</div>

									<div class="m--roulette-attention">
										<h5 class="mm_ir-blind">유의사항</h5>
										<ul class="mm_ir-blind">
											<li>해당 이벤트는 1일 1회만 참여 가능합니다</li>
											<li>엔터식스 쇼핑몰 회원에 한해서만 참여 가능합니다</li>
											<li>본 이벤트는 당사의 사정에 따라 사전 공지 없이 종료되거나 변경될 수 있습니다</li>
										</ul>
									</div>
								</div>
								<!--// 룰렛이벤트 -->
							</section>

							<!-- 현재 페이지 스크립트 -->
							<script>
								$(function() {

									var $roulette = $('.m--roulette-tables');
									$roulette.find('.btn_start').on('click', function() {

										$(this).attr({ 'disabled': true }).off('click');

										mm.ajax.load('../json/event_roulette.json', {
											configs: {
												responseType: 'json'
											},
											onComplete: function(__data) {

												// login :number - 0 로그인 전 / 1 로그인 후
												// chance :number - 0 참여완료 / 1 참여가능
												// result :number - 1~6 성공(등록된 순서) / 그 외 실패
												if (__data.login == 0) {
													mm.bom.alert('로그인이 필요합니다');
												}
												else {
													if (__data.chance == 0) {
														mm.bom.alert('1일 1회만 참여 가능합니다');
													}
													else {
														// 정상연동
														if (__data.result > 0 && __data.result < 7) {
															rouletteSpin(__data.result);
														}
														// 연동실패
														else {
															mm.bom.alert('일시적으로 서비스가 제공되지 않습니다.<br>잠시 후에 다시 시도해 주세요');
														}
													}
												}

											},
											onError: function(__error) {

												console.log('error', arguments);

											}
										});

									});

									// 룰렛 회전
									function rouletteSpin(__result) {

										// 룰렛 휠
										var $wheel =  $('.m--roulette-wheel').children('ul');
										TweenMax.to($wheel, 5, { rotation: 360 * 10 - ((__result - 1) * 360 / 6), ease: Quart.easeInOut,
											onComplete: function() {
												
												var $result = $('.m--roulette-result');
												var _alt = $wheel.find('img').eq(__result - 1).attr('alt');
												if (__result < 6) _alt = '축하드립니다! ' + _alt + ' - 당첨된  포인트는 바로 지급되며 경품은 이벤트 종료 후 일괄 지급됩니다';
												
												$result.prepend('<i class="image_point"><img class="mm_preload" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-preload="{ \'_src\': \'../images/content/event/event_roulette_result' + __result + '.png\' }" alt="' + _alt + '"></i>');
												mm.preload.update($result, { onComplete: rouletteResult })
												
											}
										});

										// 룰렛 화살표
										var $arrow = $('.image_roulette-arrow');
										TweenMax.to( $arrow, 2.5, { rotation: -100, ease: Bounce.easeOut,

											onComplete: function() {

												TweenMax.to($arrow, 2.5, { rotation: 50, ease: Bounce.easeIn });
												TweenMax.to($arrow, 1, { rotation: 0, delay: 2, ease: Elastic.easeOut });

											}

										});

									}

									// 룰렛결과
									function rouletteResult() {
										
										var $result = $('.m--roulette-result');
										TweenMax.set($result, { display: 'block', scale: 0 });
										TweenMax.to($result, 0.5, { scale: 1, ease: Back.easeOut });
										
										$result.find('.btn_close').on('click', function(__e) {
											
											location.reload();// 완료 후 새로고침
											
										})
										
									}

								});
							</script>
						</div>
						<!--// 본문 -->
					</div>
					<a href="#mm_app" class="btn_topmost" data-href="{ '_type': 'anchor' }" title="페이지 처음으로 가기"><i class="mco_topmost"></i><span>TOP</span></a>
				</div>
			</div>
			<!--// 내용 -->
		</div>
		<!--// 화면 -->

		<!-- 공통 페이지 스크립트 -->
		<script src="../js/app_page-common.js"></script>
	</div>
</body>
</html>
